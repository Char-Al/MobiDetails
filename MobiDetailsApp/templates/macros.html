<!--jinja macro input-->
{% macro input(name, type='text', value='', id=name, placeholder=name) -%}
	<input type="{{ type }}" class="w3-input w3-border" name="{{ name }}" id="{{ id }}" required="required" placeholder="{{ placeholder|capitalize }}"/>
{%- endmacro %}
<!--for fa in forms-->
{% macro fa(name, size='50px') -%}
	<div class="w3-col" style="width:{{ size }}"><i class="w3-xxlarge fa fa-{{ name }}"></i></div>
{%- endmacro %}
<!--info panel -->
{% macro info() -%}
	{% autoescape false %}
	<div class="w3-margin w3-panel w3-sand w3-leftbar">
		<p>
			{% for text in varargs %}
				<span>{{ text }}</span><br />
			{% endfor %}
		</p>
	</div><br />
	{% endautoescape %}
{%- endmacro %}
<!--danger panel -->
{% macro danger() -%}
	{% autoescape false %}
		<div class="w3-margin w3-panel w3-pale-red w3-leftbar w3-display-container">
			<span class="w3-button w3-ripple w3-display-topright w3-large" onclick="this.parentElement.style.display='none'">X</span>
			<p>
				{% for text in varargs %}
					<strong>{{ text }}</strong><br />
				{% endfor %}
			</p>
		</div>
	{% endautoescape %}
{%- endmacro %}
{# for variant page #}
{% macro section_title(id, content) -%}
	<div class="w3-text-orange w3-margin w3-panel w3-sand w3-leftbar">
		<h3 id="{{ id }}">{{ content }}</h3>
	</div>
{%- endmacro %}
{# not needed anymore
{% macro danger_variable(text, variable='', other_variable='') -%}
	{% autoescape false %}
		<div class="w3-margin w3-panel w3-pale-red w3-leftbar w3-display-container">
			<span class="w3-button w3-ripple w3-display-topright w3-large" onclick="this.parentElement.style.display='none'">X</span>
			<p><strong>{{ text }} '{{ variable }}'</strong></p><p>{{ other_variable }}</p>
		</div>
	{% endautoescape %}
{%- endmacro %}
#}
<!--highlight gnoamd oe values-->
{% macro gnomad_oe(avg, max) -%}
	{% if avg != 'NA' and avg|float <= 0.35 %}
		<td class="w3-orange">
	{% elif max != 'NA' and max|float <= 0.35 %}
		<td class="w3-red">
	{% else %}
		<td>
	{% endif %}
{%- endmacro %}
<!--gene external sites-->
{% macro gene_redirection(gene_name, urls) -%}
	<div class="w3-modal w3-animate-opacity" id="gene_modal" style="z-index:1000;">
		<div class="w3-modal-content w3-card-4 w3-display-middle w3-animate-opacity" style="width:500px;">
			<div class="w3-container w3-blue">
				<span class="w3-button w3-display-topright w3-xlarge" onclick="document.getElementById('gene_modal').style.display='none'">&times;</span>
				<h2 id="main_text">Choose your destination:</h2>
			</div>
			<div class="w3-container">
				<ul class="w3-ul w3-padding-small w3-hoverable">
					<li class="w3-padding-small">
						<span class="w3-button" onclick="window.open('{{ urls.gnomad }}awesome?query={{ gene_name }}', '_blank')">gnomAD browser</span>
					</li>
					<li class="w3-padding-small">
						<span class="w3-button" onclick="window.open('{{ urls.ncbi_gene }}{{ gene_name }}', '_blank')">NCBI gene</span>
					</li>
					<li class="w3-padding-small">
						<span class="w3-button" onclick="window.open('http://omim.org/search?index=entry&amp;start=1&amp;limit=10&amp;search={{ gene_name }}&amp;sort=score+desc%2C+prefix_sort+desc', '_blank')">OMIM</span>
					</li>
					<li class="w3-padding-small">
						<!--<span class="w3-button" onclick="window.open('http://genome-euro.ucsc.edu/cgi-bin/hgTracks?clade=mammal&amp;org=Human&amp;db=hg19&amp;position={{ gene_name }}&amp;hgt.positionInput={{ gene_name }}&amp;hgt.suggestTrack=knownGene&amp;Submit=submit', '_blank')">UCSC</span>-->
						<span class="w3-button" onclick="window.open('{{ urls.ucsc_hg19 }}{{ gene_name }}&amp;hgt.positionInput={{ gene_name }}&amp;hgt.suggestTrack=knownGene&amp;Submit=submit', '_blank')">UCSC (hg19)</span> / 
						<span class="w3-button" onclick="window.open('{{ urls.ucsc_hg38 }}{{ gene_name }}&amp;hgt.positionInput={{ gene_name }}&amp;hgt.suggestTrack=knownGene&amp;Submit=submit', '_blank')">UCSC (hg38)</span>
					</li>
					
					<li class="w3-padding-small">
						<span class="w3-button" onclick="window.open('{{ urls.marrvel }}{{ gene_name }}', '_blank')">MARRVEL</span>
					</li>
					<li class="w3-padding-small">
						<span class="w3-button" onclick="window.open('{{ url_for('md.gene', gene_name=gene_name) }}', '_self')">MD Gene page</span>
					</li>
				</ul>
			</div>
		</div>
	</div>
{%- endmacro %}
<!--create variant-->
{% macro create_variant(gene, main_iso, num_iso, res) -%}
	<input type="button"  value="Create a variant" onclick="document.getElementById('var_modal').style.display='block';$('#creation_form :input').prop('disabled', false);$('#new_variant').val('c.')" class="w3-button w3-ripple w3-blue w3-border w3-border-blue" id="add_var"/>
	<div class="w3-modal w3-animate-opacity" id="var_modal" style="z-index:1000">
		<div class="w3-modal-content w3-card-4 w3-display-middle w3-animate-opacity">
			<div class="w3-container w3-blue">
				<span class="w3-button w3-display-topright w3-xlarge" onclick="document.getElementById('var_modal').style.display='none'">&times;</span>				
				<h2 id="main_text">Create a variant ({{ "%s.%s"|format(main_iso.name[1], main_iso.nm_version) }})
				{% if num_iso > 1 %}
					<span onclick="new_isoform();" class="w3-button w3-sand" id="alt_span">Choose an isoform</span>
				{% endif %}
				</h2>				
			</div>
			<div class="w3-container">
				<form method="post" action="create_variant()" enctype="application/x-www-form-urlencoded" class="u2_form" id="creation_form">
					<input for="creation_form" id="gene" name="gene" type="hidden" value="{{ gene }}" />
					<input for="creation_form" id="isoform" name="isoform" type="hidden" value=" {{ "%s.%s"|format(main_iso.name[1], main_iso.nm_version) }}" />
					<input for="creation_form" id="acc_no" name="acc_no" type="hidden" value="{{ main_iso.name[1] }}" />
					<input for="creation_form" id="acc_version" name="acc_version" type="hidden" value="{{ main_iso.nm_version }}" />
					<!--<input for="creation_form" id="ng_accno" name="ng_accno" type="hidden" value="{{ main_iso.ng }}" />-->
					<div class="w3-panel w3-large w3-row-padding" id="new_var_div">
						<div class="w3-third">
							<label for="new_variantblue">New variant (HGVS DNA):</label>
						</div>
						<div class="w3-third">
							<input  for="creation_form" id="new_variant" maxlength="50" name="new_variant" size="20" type="text" value="c." />
						</div>
						<div class="w3-third w3-text-red" id="error_name"></div>
					</div>
					{% if num_iso > 1 %}
						<div class="w3-panel w3-large" id ="iso_form" style="display:none;">
							<!--<div class="w3-third">
								<label for="alt_iso">Select an isoform:</label>
							</div>-->
							<!--<div class="w3-twothird">-->
								<select  for="creation_form" name="alt_iso" id="alt_iso" class="w3-select">
									<option value="" selected="selected" disabled="disabled">Select an isoform</option>
									<option value="{{ "%s.%s"|format(main_iso.name[1], main_iso.nm_version) }}" >{{ "%s.%s (canonical)"|format(main_iso.name[1], main_iso.nm_version) }}</option>
									{% for iso in res %}
										{% if iso.name[1] != main_iso.name[1] %}
											<option value="{{ "%s.%s"|format(iso.name[1], iso.nm_version) }}">{{ "%s.%s"|format(iso.name[1], iso.nm_version) }}</option>
										{% endif %}
									{% endfor %}
								</select>
							<!--</div>-->
						</div>
					{% endif %}
					<div class="w3-panel">
						<p>Variant creation usually takes up to 30 seconds for variants located in genes with many isoforms</p>
					</div>
					<div class="w3-panel w3-large w3-center">
						<input type="button"  name="submit" value="Create variant" onclick="create_var();" class="w3-btn w3-blue" for="creation_form" type="submit" />
					</div>
				</form>
			</div>
		</div>
	</div>
{%- endmacro %}
{% macro info_create_variant() -%}
	<div class="w3-button w3-ripple w3-blue w3-border w3-border-blue w3-xxlarge w3-right" id="help_btn" onclick="document.getElementById('help_modal').style.display='block';$('#creation_form :input').prop('disabled', false);$('#new_variant').val('c.')">
		<i class="fa fa-info-circle" aria-hidden="true"></i>
	</div>
	<div class="w3-modal w3-animate-opacity" id="help_modal" style="z-index:1000">
		<div class="w3-modal-content w3-card-4 w3-display-middle w3-animate-opacity">
			<header class="w3-container w3-blue">
				<span class="w3-button w3-display-topright w3-xlarge" onclick="document.getElementById('help_modal').style.display='none';">&times;</span>
				<h2>Variant creation</h2>
			</header>
			<div class="w3-container">
					<p>To create a variant, you need to fill in the form with the HGVS 'c.' nomenclature. <strong>By default, the canonical isoform is selected</strong>.</p>
					<p>If your gene of interest has several isoforms in MobiDetails, please consider to use the canonical to create your variant.
					If you select an alternative isoform,  <strong>MobiDetails will try to enforce the mapping on the canonical isoform</strong>.</p>
					<ul>
						<li>If this is possible, the variant will be attached to the canonical isoform. The variant HGVS DNA nomenclature may therefore change (you will be notified).</li>
						<li>If not, the variant will be created with the isoform you selected.</li>
					</ul>
					<p>In the 'Get variants' tab, variants are shown attached to their isoform.</p>
			</div>
		</div>
	</div>
{%- endmacro %}
<!--js to close modals by cliking out of scope-->
{% macro modal_js() -%}
	<!--* {{ varargs }} -->
	<script>
		// When the user clicks anywhere outside of the modal, close it
		window.onclick = function(event) {
		 // if (event.target == document.getElementById('gene_modal') || event.target == document.getElementById('var_modal')) {
			{% for modal_div in varargs %}
				if (event.target == document.getElementById('{{ modal_div }}')) {
					document.getElementById('{{ modal_div }}').style.display = "none";
				}
				//document.getElementById('var_modal').style.display = "none";
			{% endfor %}
		  //}
		}
	</script>
{%- endmacro %}
<!--create div for variants per gene view-->
{% macro var_class_div(div_id, div_name) -%}
	<div class="w3-container w3-animate-opacity" id="{{ div_id }}" style="display:none">
		<p><span>{{ div_name }} variants recorded: </span>
		<ul class="w3-ul w3-hoverable w3-center" style="width:50%">
{%- endmacro %}
<!--create links for variants view-->
{% macro link(link, text) -%}
	<a class="w3-bar-item w3-button w3-large w3-hover-blue w3-border-bottom" href="{{ link }}" target="_blank">{{ text }}</a>
{%- endmacro %}
<!--create span with color for predictors-->
{% macro span_color(value, color = None) %}
	{% if color is defined %}
		<span style="color:{{ color }};">{{ value }}</span>
	{% else %}
		<span >{{ value }}</span>
	{% endif %}
{% endmacro %}
